# Flask Weather API

Этот проект представляет собой API на базе Flask, которое позволяет получать и хранить данные о погоде для различных городов. Данные погоды запрашиваются из внешнего API [OpenWeatherMap](https://openweathermap.org/api), а результаты сохраняются в базе данных Postgres.

## Функциональные возможности

- Добавление данных о погоде для определённого города.
- Обновление данных о погоде по ID.
- Удаление данных о погоде по ID.
- Получение данных о погоде по ID.
- Автоматическое обновление данных о погоде для списка городов (Минск, Варшава, Берлин, Париж, Нью-Йорк, Москва) каждые 24 часа.

## Стек технологий

- **Flask** — основной фреймворк для разработки API.
- **Flask-SQLAlchemy** — ORM для взаимодействия с базой данных PostgreSQL.
- **Flask-Migrate** — утилита для миграций базы данных.
- **APScheduler** — для планирования периодического обновления данных.
- **PostgreSQL** — база данных для хранения данных о погоде.
- **requests** — библиотека для выполнения HTTP-запросов.
- **OpenWeatherMap API** — внешний API для получения данных о погоде.


### Шаги по установке
1. **Клонирование репозитория:**
git clone https://github.com/your-username/weather-api.git
cd weather-api   
2. **Создание и активация виртуального окружения:**
Для Windows:
python -m venv venv
venv\Scripts\activate
3. **Установка зависимостей:**
pip install -r requirements.txt
4. **Настройка переменных окружения:**
Создайте файл .env в корне проекта и добавьте следующие переменные:
DATABASE_URL=postgresql://<ваш_пользователь_postgres>:<ваш_пароль>@localhost/<ваше_имя_базы_данных>
WEATHER_API_KEY=<ваш_ключ_от_OpenWeatherMap>
5. **Создание базы данных:**
В PostgreSQL создайте базу данных, соответствующую DATABASE_URL, указанной в файле .env.
6. **Применение миграций:**
flask db init
flask db migrate
flask db upgrade
7. **Запуск приложения:**
flask run


Приложение будет доступно по адресу `http://127.0.0.1:5000/`.

## Endpoints API

- **POST /weather** — добавляет данные о погоде вручную.
- **PUT /weather/<id>** — обновляет данные о погоде по ID.
- **DELETE /weather/<id>** — удаляет данные о погоде по ID.
- **GET /weather/<id>** — получает данные о погоде по ID.
- **POST /weather/fetch/<city>** — получает данные о погоде через OpenWeatherMap для указанного города.

## Периодическое обновление данных

API автоматически обновляет данные о погоде для городов каждые 24 часа, используя планировщик задач APScheduler. Список городов можно изменить в файле `__init__.py`.


